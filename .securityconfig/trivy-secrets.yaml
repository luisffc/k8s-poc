# Trivy Secret Scanning Configuration
# This is separate from GitLeaks configuration as Trivy uses its own format

# Custom secret detection rules for Trivy
rules:
  - id: "github-token"
    category: "token"
    title: "GitHub Personal Access Token"
    regex: "gh[pousr]_[A-Za-z0-9_]{36,251}"
    keywords:
      - "github"
      - "token"
      - "ghp_"
      - "gho_"
      - "ghu_"
      - "ghs_"
      - "ghr_"

  - id: "docker-config"
    category: "config"
    title: "Docker configuration secrets"
    regex: "(docker|registry).*[\"\\']([a-zA-Z0-9+/=]{20,})[\"\\']"
    keywords:
      - "docker"
      - "registry"
      - "auth"

  - id: "k8s-secret"
    category: "config"
    title: "Kubernetes secrets"
    regex: "kubectl.*secret.*[\"\\']([a-zA-Z0-9+/=]{10,})[\"\\']"
    keywords:
      - "kubectl"
      - "secret"
      - "kubernetes"

# Allowlist for known false positives
allowlist:
  - rule-id: "github-token"
    paths:
      - "**/test/**"
      - "**/tests/**"
      - "**/*test*"
      - "**/*example*"

  - rule-id: "docker-config"
    paths:
      - "**/test/**"
      - "**/tests/**"
      - "**/*test*"

# Additional settings
settings:
  # Disable specific built-in rules if needed
  disabled-rules: []

  # Only scan specific file types
  target-file-patterns:
    - "*.py"
    - "*.yaml"
    - "*.yml"
    - "*.json"
    - "*.toml"
    - "*.ini"
    - "*.conf"
    - "*.sh"
    - "Dockerfile*"
